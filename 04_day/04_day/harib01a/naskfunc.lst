     1                                  ; naskfunc
     2                                  ; TAB=4
     3                                  
     4                                  ;[FORMAT "WCOFF"]				; オブジェクトファイルを作るモード ; NASMではエラーが出るのでこの行削除
     5                                  [BITS 32]						; 32ビットモード用の機械語を作らせる
     6                                  
     7                                  
     8                                  ; オブジェクトファイルのための情報
     9                                  
    10                                  ;[FILE "naskfunc.nas"]			; ソースファイル名情報 ; NASMではエラーが出るのでこの行削除
    11                                  
    12                                  		;GLOBAL	_io_hlt,write_mem8		; このプログラムに含まれる関数名
    13                                  		GLOBAL	io_hlt,write_mem8		; NASMではエラーが出るので修正
    14                                  
    15                                  
    16                                  ; 以下は実際の関数
    17                                  
    18                                  [SECTION .text]		; オブジェクトファイルではこれを書いてからプログラムを書く
    19                                  
    20                                  ;_io_hlt:	; void io_hlt(void);
    21                                  io_hlt:	; void io_hlt(void);	; NASMではエラーが出るので修正
    22 00000000 F4                      		HLT
    23 00000001 C3                      		RET
    24                                  
    25                                  ;_write_mem8:    ; void write_mem8(int addr, int data);
    26                                  write_mem8:    ; void write_mem8(int addr, int data);	; NASMではエラーが出るので修正
    27 00000002 8B4C2404                                MOV             ECX,[ESP+4]             ; [ESP+4]にaddrが入っているのでそれをECXに読み込む
    28 00000006 8A442408                                MOV             AL,[ESP+8]              ; [ESP+8]にdataが入っているのでそれをALに読み込む
    29 0000000A 8801                                    MOV             [ECX],AL
    30 0000000C C3                                      RET    
    31                                  
